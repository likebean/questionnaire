# 问卷系统 - 完整功能规格

> 仿问卷星，仅做功能整理，不涉及实现细节。按模块逐条列出，便于后续排期与开发。  
> **目标客户**：高校各系。需与高校 CAS 统一认证、用户体系（身份/院系等）对接。

---

## 一、用户与账号

### 1.1 注册与登录
- **高校环境（主）**：对接学校 CAS，使用「统一身份认证」登录，无需在本系统注册；见「二、高校对接」。
- **本地账号（辅）**：未启用 CAS 或需兼容时：注册（邮箱 + 密码、可选手机号）、邮箱/手机号 + 密码登录、忘记密码。
- 登录态：Session/Token，支持「记住我」时长。
- 未登录可访问：仅填写问卷（若问卷允许匿名）；创建/编辑/查看数据需登录。

### 1.2 个人中心
- 基本信息：昵称、头像、邮箱、手机（可修改，需验证）；**来自 CAS/用户体系时**：可展示学号/工号、姓名、院系等（只读或同步展示）。
- 修改密码：仅本地账号；CAS 用户改密走学校统一入口。
- 我的问卷列表：全部/草稿/收集中/已结束，支持搜索、按时间排序。
- 配额与用量（若做收费）：问卷数量、回收份数、有效期等展示。

### 1.3 权限与归属
- 每条问卷归属一个用户（创建者）。
- 仅创建者可：编辑问卷、查看/导出数据、修改发放设置、复制/删除问卷。
- 后续可扩展：协作成员、只读/编辑权限；**按院系/角色授权**（见高校对接）。

---

## 二、高校对接（CAS 与用户体系）

### 2.1 目标与范围
- **目标客户**：高校各院系（如教务处、学工、各学院办公室等）。
- 系统需支持接入**校内 CAS** 与**用户体系**，实现统一登录、身份识别、可选按院系/角色做权限与统计。

### 2.2 CAS 统一认证对接
- 支持标准 **CAS 2.0 / CAS 3.0** 协议（登录、登出、Service Ticket 校验）。
- 配置项（按学校/部署可配）：CAS 服务器地址、登录 URL、登出 URL、本系统 Service 地址、证书/白名单等。
- 流程：用户点击「统一身份登录」→ 跳转学校 CAS → 认证成功后 CAS 回调带 Ticket → 本系统校验 Ticket 并建会话。
- 登出：支持单点登出（CAS 通知本系统清除会话），或本系统仅本地登出。
- 多校/多环境：若支持多所高校部署，需支持**多套 CAS 配置**（按域名或租户切换）。

### 2.3 用户体系对接（身份与组织）
- **从 CAS 或对接接口获取的用户信息**（至少）：  
  - 唯一标识（如学号/工号或统一 ID）  
  - 姓名  
  - 身份类型：学生 / 教职工 / 其他（以学校实际字段为准）  
  - 院系/单位：院系代码、院系名称（可选：多级单位、年级、班级等）  
- **对接方式**（按学校能力二选一或并存）：  
  - **方式 A**：CAS 属性（Attribute）在登录回调时一并返回，本系统解析并落库/写 session。  
  - **方式 B**：本系统仅从 CAS 拿到唯一 ID（或学工号），再调用学校**用户中心/人事/学工 API** 拉取姓名、院系、身份等。  
- 用户信息在本系统的使用：  
  - 个人中心展示、问卷创建者标识、答卷「填写人」关联（若要求登录后填写）。  
  - **按院系统计/筛选**：如「仅统计某院系答卷」「按院系看回收量」「仅某院系可发布某类问卷」等（可选，依校方需求）。

### 2.4 权限与范围（可选，依校方需求）
- **按身份控制**：如仅教职工可创建问卷、学生仅可填写；或按角色（管理员/院系管理员/普通用户）区分。
- **按院系/单位控制**：问卷可见/可编辑范围限定在某院系；或答卷数据仅院系管理员可见。
- 以上可与「一、1.3 权限与归属」合并实现，数据模型上需支持「用户 → 院系/角色」关联。

### 2.5 填写端与防重复（高校场景）
- **要求登录后填写**：填写前先跳转 CAS 登录，再进入问卷；答卷与「当前登录用户」绑定，便于按人防重复、按身份/院系统计。
- **防重复**：同一用户（同一学号/工号）仅能提交一次，可选「同一问卷同一用户仅一次」。
- **匿名与实名**：支持问卷级设置「允许匿名」或「仅登录用户可填」；若仅登录用户可填，可配置是否在导出/统计中展示学号、姓名、院系（脱敏策略依校方规定）。

### 2.6 运维与安全
- CAS 与用户接口的 **HTTPS、IP 白名单、调用限流** 等由部署与学校约定。
- 用户信息缓存与同步：首次 CAS 登录后在本系统落库或缓存；若学校提供用户变更通知，可做增量同步，否则可定时全量/按需拉取。
- 合规：用户隐私与数据留存周期需符合学校及教育主管部门要求，在隐私说明中体现。

### 2.7 院系与权限设计（含租户建议）

#### 设计结论（已采纳）
- **租户**：仅用于「学校」层级。一所高校一个租户；多校部署时做数据与配置隔离，单校时保留租户维度便于扩展。**院系不作为租户。**
- **院系**：作为校内组织树，归属某租户；用户、问卷可关联院系，用于展示、权限范围与统计。
- **权限**：采用「角色（校管 / 院系管理员 / 普通用户）+ 身份（教职工 / 学生）+ 数据范围（本人 / 本院系 / 本校）」；数据范围在查询时按角色与院系过滤，不另做院系级租户。

#### 租户是否适合用在这里
- **结论：租户适合用在「学校」这一层，院系不适合当租户。**
- **租户（tenant）= 一所高校**  
  - 多所高校共用一套系统时，每校一个租户：数据隔离（A 校看不到 B 校）、登录隔离（只能登本校 CAS）、配置隔离（每校自己的 CAS 地址、名称、院系树等）。  
  - 若只服务一所高校，可以单租户，但表结构仍建议带 `tenant_id`，便于以后扩展多校。
- **院系 ≠ 租户**  
  - 院系是**同一所学校内部**的组织结构（学院、系、所、中心等），是树形组织，属于某个租户。  
  - 用院系做租户会导致：同一学校被拆成几十个「租户」，CAS 和用户体系要按院系重复对接，不合理；数据按「学校」隔离才是常态。

#### 院系模型建议
- **组织树**：院系为树形结构，节点类型可简化为「院系」（或再拆学院/系/所）。  
  - 字段建议：唯一编码、名称、父节点、层级、排序、所属租户（学校）。  
  - 与学校用户中心同步：支持从接口全量/增量同步，或仅同步「用户所属院系」编码，院系名称由本校接口提供。
- **用户与院系**  
  - 用户归属院系：一个用户对应一个主院系（或主院系 + 兼职院系列表，依校方实际）。  
  - 通过 CAS 或用户中心接口带入；本系统存「用户 – 院系」关联，用于展示、权限范围、统计筛选。
- **问卷与院系（可选）**  
  - 问卷可挂「归属院系」：创建者所在院系自动带出，或允许创建者选择（如代某院系建卷）。  
  - 用于：院系管理员只看本院系问卷/数据、按院系统计回收量等。

#### 权限模型建议（角色 + 数据范围）
- **角色（按租户/校区分）**  
  - **平台级**：超级管理员（仅多租户 SaaS 时有，管所有学校）。  
  - **租户级（校内）**：  
    - 租户管理员（校管）：本校 CAS/用户同步配置、本院系树维护、本校用户/角色管理、看本校全部问卷与数据。  
    - 院系管理员：管理本院系及子院系，可看本院系下问卷与答卷、可选「代本院系发布」或审批。  
    - 普通用户：教职工/学生，可创建问卷（若开放）、填答，数据范围仅「本人创建的问卷」。  
  - 身份类型（学生/教职工）可单独做**能力开关**（如仅教职工可创建问卷），与角色可叠加使用。
- **数据范围（与角色配合）**  
  - 问卷列表：本人 / 本院系 / 本租户全部。  
  - 答卷查看/导出：本人创建的问卷 / 本院系问卷 / 本租户全部。  
  - 实现方式：查询时用「当前用户角色 + 所属院系」做过滤（如院系管理员 => `WHERE questionnaire.department_id IN (本院系及子院系)`）。
- **不建议院系当租户**：权限用「角色 + 院系范围」即可实现「按院系看、按院系管」；院系作为组织维度在单租户内使用即可。

#### 小结
| 概念     | 建议用法 |
|----------|----------|
| 租户     | 一所高校；多校部署时用租户做隔离与配置边界。 |
| 院系     | 校内组织树，归属某租户；用户/问卷可关联院系。 |
| 权限     | 角色（校管/院系管理员/普通用户）+ 身份（教职工/学生）+ 数据范围（本人/本院系/本校）。 |

---

## 三、问卷编辑（对标问卷星）

> 以下根据问卷星官方帮助与能力（约 90+ 题型、逻辑设置、外观、AI 等）整理，便于逐项对标与排期。标注 **★问卷星** 表示问卷星已具备；未标注的为本规格建议能力。

### 3.1 问卷基础信息
- 问卷标题（必填）、问卷说明/前言（富文本或纯文本，选填）
- 问卷封面图（可选）★问卷星
- 问卷状态：草稿、收集中、已结束（手动结束或按结束时间自动结束）
- 应用类型（可选）：调查问卷、在线考试、报名表单、投票、测评等，影响题型入口与统计展示 ★问卷星

### 3.2 题型列表（完整对标问卷星）

问卷星提供 **90+ 题型**，按类别整理如下；本系统可按优先级分阶段实现。

#### 3.2.1 基础题型（必对标准）

| 序号 | 题型 | 说明 | 问卷星 |
|------|------|------|--------|
| 1 | 单选题 | 单选一项，可配跳题/关联/引用 | ✓ |
| 2 | 多选题 | 多选，最少/最多勾选数、选项随机 | ✓ |
| 3 | 单选下拉 | 下拉框单选 | ✓ |
| 4 | 多选下拉 | 下拉框多选 | ✓ |
| 5 | 填空题 | 单行文本，校验（数字/邮箱/手机等） | ✓ |
| 6 | 多行填空题 | 多行文本/段落 | ✓ |
| 7 | 矩阵单选题 | 行×列，每行选一列 | ✓ |
| 8 | 矩阵多选题 | 行×列，每行可多选列 | ✓ |
| 9 | 矩阵填空题 | 行×列，每格一空 | ✓ |
| 10 | 量表/评分题 | 线性量表、NPS（0–10）、满意度、自定义端点文案 | ✓ |
| 11 | 排序题 | 拖拽或点选排序，选项可随机 | ✓ |
| 12 | 比重题 | 若干项分配比例（如总和 100%） | ✓ |
| 13 | 日期题 | 选择日期，可限制范围 ★问卷星 | ✓ |
| 14 | 时间题 | 选择时间或日期+时间 | ✓ |
| 15 | 上传文件题 | 单/多文件，类型与大小限制 | ✓ |
| 16 | 段落说明 | 仅展示文字/图片，不收集答案 | ✓ |
| 17 | 分页符/分页栏 | 仅用于分页，可选分页计时 ★问卷星 | ✓ |
| 18 | 表格题 | 自定义行列的表格填空/选择 | ✓ |
| 19 | 投票题 | 单选但按选项计票展示 | ✓ |
| 20 | 多级下拉 | 省市区、层级选项联动 | ✓ |

#### 3.2.2 高级与输入增强（对标可选）

| 题型 | 说明 | 问卷星 |
|------|------|--------|
| 滑动条 | 滑块选数值/程度 | ✓ |
| 商品题 | 商品选择、数量、价格类 | ✓ |
| 手机验证题 | 填写手机号并收验证码 | ✓ |
| 超长文本录入 | 大段文本、适合访谈纪要 | ✓ |
| 语音录入 | 语音转文字 | ✓ |
| 答题录音/摄像 | 提交音视频作为答案 | ✓ |
| 绘制签名题 | 手写签名 | ✓ |
| 考试绘图题 | 在图片上标注/绘图 | ✓ |
| 自增表格题 | 动态增删行的表格 | ✓ |
| 考试简答/多空/多选 | 与考试场景结合的题型 | ✓ |
| 地图题 | 选点/选区域 | ✓ |
| 热力图/热力图选区 | 在图片上点选区域 | ✓ |
| 轮播图 | 以轮播形式展示选项或题目 | ✓ |
| 折叠栏目 | 折叠展示大段内容 | ✓ |
| 视频题 | 观看视频后作答 | ✓ |
| 预约 | 选择预约时段 | ✓ |
| 企业信息查询 | 根据企业名等查询并回填 | ✓ |
| OCR 识别/扫码录入 | 扫码或拍照识别内容填入 | ✓ |
| 学信网验证码 | 学籍/学历验证 | ✓ |
| 双码拼接 | 两个条形码拼接等 | ✓ |

#### 3.2.3 调研与专业模型题型（问卷星特色，可选对标）

| 题型 | 说明 | 问卷星 |
|------|------|--------|
| MaxDiff 最大差异 | 最大化差异度量 | ✓ |
| 图片 PK | 多图比较选择 | ✓ |
| 联合分析 | 属性组合偏好 | ✓ |
| KANO 模型 | 需求分类分析 | ✓ |
| SUS 模型 | 可用性量表 | ✓ |
| 品牌漏斗 | 品牌认知漏斗 | ✓ |
| 货架题 | 货架陈列/选择 | ✓ |
| 循环评价题 | 多对象循环打分 | ✓ |
| 情景随机题 | 随机情景与题目 | ✓ |
| PSM 价格敏感度 | 价格敏感度模型 | ✓ |
| 价格断裂点（Gabor Granger） | 定价模型 | ✓ |
| AHP 层次分析 | 层次分析法 | ✓ |
| TURF 分析 | 触达与频率分析 | ✓ |
| BPTO 模型 | 行为偏好等 | ✓ |
| 选项分类 | 将选项拖入分类（如卡片分类） | ✓ |
| 文字点睛题 | 在文本上点选/标注 | ✓ |
| 门店选择题 | 按地图/列表选门店 | ✓ |
| 城市级别 | 城市层级选择 | ✓ |
| 漏斗选项 | 漏斗型选项展示 | ✓ |
| VlookUp 问卷关联 | 与外部数据关联回填 | ✓ |
| 心理学实验题型 | 实验用题型 | ✓ |
| CATI 调研 | 电话调研相关 | ✓ |
| 错题练习 | 练习与错题本 | ✓ |

### 3.3 题目通用设置
- 题目标题（题干）、题目说明/备注（选填）
- 是否必填、题目序号（自动编号或自定义，如 1.2.3 / Q1）
- 选项/行/列：可编辑、增删、排序；选项「其他」+ 后续填空
- **选项引用**：下一题选项来源于前面某题的被选选项（如「知道的品牌」→「正在使用的品牌」）★问卷星
- **计算公式/赋值**（尊享版等）：根据前面题目或填空内容自动选中某选项或计算分数；可设置「允许/不允许填写者修改自动选中项」★问卷星
- 数学/化学公式展示（LaTeX 等）★问卷星

### 3.4 题型专属设置（补充问卷星能力）
- **单选/多选/下拉**：选项随机、多选最少/最多项、标签化呈现选项 ★问卷星
- **填空**：占位提示、校验类型（数字/整数/邮箱/手机/身份证/URL/正则）、长度限制；日期题可设日期范围 ★问卷星
- **矩阵题**：行/列可随机、每行必选可选、矩阵题单题作答（一题一矩阵）★问卷星
- **量表/评分**：刻度类型、左右端点文案、NPS 等预设
- **排序题**：选项随机
- **上传文件**：类型、大小、数量限制；考试文件题可设得分规则 ★问卷星
- **评价题**：多维度评价、权重 ★问卷星

### 3.5 逻辑设置（完整对标问卷星）

问卷星支持 **跳题、题目关联、选项关联、选项引用、反向关联** 四类逻辑；推荐优先用「题目关联」实现显隐，再辅以跳题。

- **跳题逻辑** ★问卷星  
  - 按选项跳转：单选题某选项选中后跳转到指定题或结束答卷（多题组合时常需配合「无条件跳转」）。  
  - 无条件跳转：从当前题直接跳转到某题或结束。  
  - 适用：样本筛选（如选「男」直接结束）、简单分支。  
- **题目关联逻辑（显隐）** ★问卷星（推荐）  
  - 某题的**显示与否**与前面某题的**选项是否被选中**关联；未设置关联时题目可默认显示或默认不显示。  
  - 逻辑清晰、易维护，多数「选某选项后做某题」的场景用题目关联即可，无需复杂跳题。  
- **选项关联逻辑** ★问卷星  
  - 同一题内**不同选项的显示/隐藏**与前面某题选项关联（如性别选「男」才显示「足球/篮球」，选「女」才显示「手工/美妆」）。  
- **选项引用逻辑** ★问卷星  
  - 将前面某题的**被选选项**作为本题的选项列表（如第一题选「知道的品牌」，第二题选项仅为第一题所选品牌）。  
- **反向关联** ★问卷星  
  - 由后续题目反向关联到前面题目，用于特殊逻辑。  
- 实现注意：支持多条件组合时，可用与(&&)、或(||)、非(!) 等逻辑组合；被隐藏题目不参与题号连续展示时，题号可重排或保持原号。

### 3.6 问卷级设置
- **分页**：不分页 / 按分页符 / 每 N 题一页；是否允许「上一页」返回修改 ★问卷星  
- **时间**：开始时间、结束时间；单次填写限时（如 10 分钟内提交）★问卷星  
- **回收与配额**：最大回收份数；**配额规则**（如某选项最多回收 100 份、按条件分桶配额）★问卷星  
- **防重复**：不限制 / 同一设备 / 同一用户（登录） / 同一 IP 限频  
- **质量控制** ★问卷星：答题时间控制、重复答卷筛选、自动筛选（根据答案筛无效）  
- **提交设置**：感谢语、提交后跳转链接、是否允许查看/分享结果；**自定义感谢页/结果页** ★问卷星  
- **密码**：问卷填写密码（可选）★问卷星  
- **红包/抽奖/奖品**（可选）：提交后红包、抽奖、兑奖规则 ★问卷星  

### 3.7 外观与展示（对标问卷星显示设置与外观）

- **显示项** ★问卷星  
  - 是否显示问卷标题、是否显示「上一页」、是否显示二维码、是否显示题型标签（如「多选」「排序」）。  
- **进度条** ★问卷星  
  - 按题目数（已答/总题数）或按分页（当前页/总页数）；位置可为问卷顶端横向条。  
- **提示语言**：问卷内提示文字语言（中/英等）★问卷星  
- **按钮文案**：提交按钮、上一页/下一页按钮文字可自定义 ★问卷星  
- **主题与样式** ★问卷星  
  - 主题色、字体、字号；电脑端与手机端可分别设计；高度定制问卷外观样式。  
- **选项呈现**：单选/多选可设为**标签化形式**呈现 ★问卷星  
- **题目编号**：数字、字母、无编号等  
- **水印**：针对填写者的特有水印（防作弊/溯源）★问卷星  
- **问卷外观设计指引**：提供设计建议与规范 ★问卷星  

### 3.8 批量与效率
- **批量录入**：从 Word/Excel 粘贴或导入题目，按约定格式解析为题目与选项 ★问卷星  
- **题库**：个人题库/企业题库，从题库选题插入问卷；题库分类、标签、搜索  
- **一键录入**：客服/人工代录时按模板批量导入 ★问卷星  

### 3.9 题目与问卷操作
- 题目：新增、复制、删除、上移/下移、从题库或模板插入  
- 问卷：保存草稿、发布（开始回收）、暂停回收、结束问卷、复制问卷、删除问卷  
- **从模板创建**：按应用类型或行业选择模板，基于模板生成问卷 ★问卷星  

### 3.10 AI 辅助（可选对标问卷星）

问卷星已提供多种 AI 能力（多属企业版，消耗 AI 点数）：

- **AI 创作问卷题目**：根据主题/场景一键生成题目 ★问卷星  
- **智能生成选项**：根据题干自动生成选项 ★问卷星  
- **AI 翻译**：题目/选项多语言 ★问卷星  
- **简答题智能阅卷**：按评分标准对主观题自动阅卷 ★问卷星  
- **AI 追问**：根据填写者回复内容自动追问 ★问卷星  
- **AI 交互**：对提交的文本/图片进行加工或回复 ★问卷星  
- **AI 报告 / AI 观点分析**：基于回收数据生成分析报告、观点归纳 ★问卷星  
- **AI 解读**：如 360 测评的个性化解读 ★问卷星  

本系统若需对标，可规划为后续版本，并考虑自建大模型或对接第三方 API。

**AI / Agent 对接方式（建议纳入设计）**  
- **CLI**：提供命令行工具，便于 AI Agent 在脚本或自动化流程中调用，完成创建问卷、生成/编辑题目、读取问卷结构、提交/拉取答卷、触发分析或导出等操作；支持非交互式（unattended）执行与标准输入/输出，方便与各类 Agent 框架集成。  
- **REST API**：与 CLI 能力对齐的 HTTP API（鉴权、问卷 CRUD、题目、答卷、统计、导出），供远程 Agent 或第三方系统调用。  
- **Webhook（可选）**：答卷提交、问卷状态变更等事件回调，便于 Agent 做后续编排（如自动分析、通知、入库）。  
- 设计时预留：同一套能力同时支撑「Web 界面」「CLI」「API」，避免仅面向界面导致 Agent 难以复用。

### 3.11 高校场景下明显不适用或可弱化的功能

目标客户为高校时，以下能力多为商业/市场调研场景设计，**校内几乎用不到**，建议不做或低优先级，便于资源集中在教学评估、学工调查、报名投票等场景。

| 类别 | 功能/题型 | 说明 |
|------|-----------|------|
| **激励与付费** | 红包、抽奖、奖品、收款 | 高校问卷多为课程/行政任务，很少用现金或抽奖激励；若需小礼品多为线下发放，不必内置支付与兑奖。 |
| **商业与零售** | 门店选择题、货架题、商品题 | 选址/陈列/商品选择属市场调研，校内无典型场景。 |
| **企业/B2B** | 企业信息查询、VlookUp 问卷关联（外部名单回填） | 面向企业名单、CRM 对接，高校一般不涉及。 |
| **定价与市场研究** | PSM 价格敏感度、价格断裂点（Gabor Granger） | 定价类调研多用于商业决策，非高校主流需求。 |
| **品牌与渠道** | 品牌漏斗 | 品牌认知漏斗多为商业调研，高校极少使用。 |
| **电访与样本外包** | CATI 调研、第三方样本服务、决策鹰 | 电话调研与付费样本多为商业项目，高校自填为主。 |
| **验证方式** | 手机验证码题（短信验证） | 高校已用 CAS/统一身份，一般不需再短信验证；可保留为可选，优先级低。 |
| **预约与收款** | 预约（时段预约）、问卷内收款 | 场地预约可用专门系统；培训费/报名费若收费，多走学校财务，非问卷核心。 |
| **高度商业的展示** | 轮播图、部分「情景随机」用于营销 | 若仅用于营销 A/B 展示可弱化；学术实验若需随机可保留简化版。 |

**建议**：  
- 以上功能在高校版中**可不实现**或列为 P3 及以后。  
- 保留：基础题型、逻辑（跳题/关联/引用）、问卷设置（分页/限时/防重复/感谢页）、外观、批量导入、题库、导出 Excel/SPSS；教学评估、满意度、NPS、考试、报名、投票、测评等与校内强相关的能力优先。

---

## 四、发放与回收（对标问卷星）

> 以下根据问卷星「回收答卷」相关帮助整理，便于逐项对标。标注 **★问卷星** 表示问卷星已具备。高校场景下，邀请以 CAS/链接/二维码为主，短信/邮件/微信邀请可弱化或可选。

### 4.1 发放方式

#### 4.1.1 链接与二维码 ★问卷星
- **问卷链接**：永久链接（与问卷绑定）、短链接（如 /s/xxxx 或 /jq/xxxx）；发布页获取问卷地址后直接分享。
- **二维码**：生成问卷链接对应的二维码图片，可下载；**制作二维码海报**（海报模板 + 二维码，便于线下/印刷分发）★问卷星
- **自定义来源与调研员**：链接上带自定义参数（如 `source=channel1`、`surveyor=张三`），用于区分投放渠道或调研员，便于后续**答卷来源分析** ★问卷星

#### 4.1.2 嵌入到网站 ★问卷星
- **iframe 嵌入**：提供 iframe 代码，可设宽高，将问卷嵌入自有网站/博客。
- **JS 嵌入**：部分场景（如免登录嵌入、兼容 Safari 等）提供脚本方式嵌入（如 `script src=...&url=问卷地址&width=&height=`）。
- **嵌入时可配合**：免登录/单点登录链接（见下）、自定义链接参数。

#### 4.1.3 自定义链接参数与免登录 ★问卷星
- **自定义链接参数 API**：通过 URL 参数控制问卷行为，例如指定显示题目、预填题目、区分来源；参数可加密（如 SHA1：appid+appkey+username+…+ts → sign），防止篡改。
- **免登录/单点登录**：在已有系统内打开问卷时，通过带签名的链接（如 appid、username、mobile、ts、sign）实现免登录填写，无需再次认证；高校场景可与此处对接 CAS 或统一身份，实现「从教务/学工系统点开即填」。

### 4.2 邀请方式（触达填写者）

#### 4.2.1 短信邀请 ★问卷星
- 手动输入填写者手机号；从 **Excel 批量导入** 手机号。
- **短信 + 语音通知** 组合提醒。
- 可勾选「**只允许通过系统短信中的链接访问此问卷**」：仅通过短信内链接进入方可填写，其他入口提示不允许，用于防扩散、防重复与来源控制。

#### 4.2.2 邮件邀请 ★问卷星
- 从 **Excel 导入** 邮箱地址；**批量重发** 邀请邮件。
- 邮件中可**插入题目**（如个性化称呼、题目内容）；可配置**附加属性字段** 在邮件中展示。
- 支持**自有邮件系统** 发送（SMTP 等）。
- 可勾选「**只允许通过系统邮件中的链接访问此问卷**」：仅邮件内链接可填写，其余入口拦截。

#### 4.2.3 微信邀请 ★问卷星
- **公众号**：图文消息中插入问卷星小程序或 H5 链接；可设置「**必须关注公众号后才能作答**」；关注后自动发问卷链接或自动邀请。
- **小程序**：在自有小程序中跳转打开问卷（小程序内或 H5）；支持**限制指定微信群** 作答（仅某群成员可填）。
- **按条件处理**：根据答卷内容向填写者**微信发送** 指定内容（如结果、提醒、下一份问卷链接）★问卷星
- 高校场景：若校内用企业微信/公众号，可保留「链接 + 二维码」为主，微信邀请为可选。

### 4.3 填写限制与入口控制 ★问卷星
- **仅邮件/仅短信链接可填**：见 4.2.1、4.2.2。
- **限制特定 App 才能作答**：指定仅从某应用（如自有 App、企业微信）内打开链接时可填，其他入口提示不允许。
- **限制指定微信群**：仅某微信群成员可填（微信环境）。
- **必须关注公众号后作答**：公众号场景下先关注再填。

### 4.4 防重复填写（完整对标问卷星）

问卷星支持多种方式单独或组合使用：

| 方式 | 说明 | 问卷星 |
|------|------|--------|
| **密码列表** | 每个填写者唯一密码，输入正确方可进入；可设置填一次后密码失效；支持从 Excel 批量导入密码列表 | ✓ |
| **短信验证码** | 填写者输入手机号并获取验证码，验证通过后进入问卷 | ✓ |
| **IP 限制** | 同一 IP 仅允许提交一次（注意：同一路由器/机房会共 IP，慎用于宿舍/办公室） | ✓ |
| **同一电脑/手机** | 基于 Cookie/设备标识，同一设备仅能提交一次 | ✓ |
| **微信用户次数** | 需微信授权，按微信号限制填写次数（如每微信号 1 次） | ✓ |
| **仅邮件/仅短信链接** | 仅通过系统发送的邮件/短信中的链接进入才可填，实现「一人一环」 | ✓ |
| **同一登录用户** | 需填写者登录（如 CAS），按用户 ID 限制次数；高校主推 | 本系统 |

未通过时：提示「已填写过」「该链接已使用」或「请通过邮件/短信中的链接访问」等，可配置文案。

### 4.5 回收控制与配额（与第三章 3.6 对应）

#### 4.5.1 时间与总量
- **问卷有效期**：开始时间、结束时间（到点自动开放/关闭）★问卷星
- **单次填写限时**：每份答卷需在 N 分钟内完成，超时提交无效或提示 ★问卷星
- **最大回收份数**：达到后自动关闭或提示「回收已满」★问卷星
- **每日配额**：按自然日限制每日最大回收数 ★问卷星

#### 4.5.2 配额规则 ★问卷星
- **基础配额**：按某题某选项设定「该选项最多被选 N 次」，达到后该选项不可选或选后提交判为无效。
- **显式 / 隐式**：显式——进入问卷即显示「某选项已满」且不可选；隐式——仍可选，提交后提示不符合调查要求。
- **交叉配额**：按两个题目组合设定配额（如「性别×批次」：每批次男/女各最多 20 人）。
- **高级配额**：多条件、多维度组合配额（如来源省份/城市 + 选项等）；来源为地区时可为手动输入省份/城市。

### 4.6 质量控制（筛选无效答卷）★问卷星

- **答题时间控制**：设置填写最少时间，短于该时间的答卷可自动标记无效或不计入统计。
- **甄别页**：在正式题目前设置甄别题，未通过者直接结束或不计入有效样本。
- **自动筛选规则**：按条件自动标记/排除无效答卷，如：最少作答时间、地区限制、职业/年龄等属性限制。
- **筛选重复选择相同答案的答卷**：识别整份答卷中选项高度重复（如全选同一项）的答卷，支持批量标记或排除 ★问卷星
- **AI 智能清洗答卷**：自动识别低质量/异常答卷并建议处理 ★问卷星

### 4.7 填写端体验

- 填写页：根据逻辑跳题/题目关联与分页展示题目，必填与格式校验；提交前确认（可选）★问卷星
- 提交成功：感谢语、自定义感谢页、跳转链接（若配置）；可选「提交后允许查询已填答卷」★问卷星
- 提交失败：网络错误或校验失败时提示；配额已满、防重复未通过等统一提示。
- **断点续答**：同一设备/用户未提交前再次打开，可恢复上次填写内容 ★问卷星
- **便捷答卷查询 / 成绩查询**：填写者通过唯一码/学号等查询自己的提交结果或成绩 ★问卷星
- **多语言**：一份问卷支持多语言切换（若需）★问卷星

### 4.8 回收监控与来源分析（创建者端）

- **实时回收数量**：今日新增、总回收数、状态（收集中/已结束/已满）★问卷星
- **答卷来源分析**：按「链接参数、渠道、调研员、来源页」等维度统计答卷分布，评估投放效果 ★问卷星
- 列表/仪表盘：回收趋势、筛选无效/有效答卷、导出时可选仅有效答卷

---

## 五、数据与统计（对标问卷星）

> 以下根据问卷星「统计分析」「查看&下载」相关帮助整理，便于逐项对标。标注 **★问卷星** 表示问卷星已具备。高校场景下，分类统计、交叉分析、导出 Excel/SPSS、答卷列表与无效标记为刚需；数据大屏、多问卷分析、测评报告等可按需规划。

### 5.1 答卷列表与查看（查看原始答卷）★问卷星

- **列表字段**：提交时间、所用时间、IP、来源（渠道/省份/城市）、设备或标识、部分题目答案摘要；可选显示/隐藏参与者信息（脱敏）★问卷星
- **操作**：单条查看详情、**删除**不需要的答卷、**标记无效**（不计入统计）；支持批量删除或批量标记 ★问卷星
- **筛选**：按时间范围、按题目答案筛选（如「第 2 题选了 A 的答卷」）、按来源/地区筛选、仅有效答卷/仅无效答卷 ★问卷星
- **分页**：分页浏览，支持导出**当前筛选结果**（仅导出符合条件的数据）★问卷星
- **分享特定条件的数据**：按条件筛选后，可生成仅包含该部分数据的分享链接或导出包，便于协作或对外提供子集 ★问卷星
- **成绩分布图 / 分类查看**：考试/测评场景下，按班级、院系等维度查看成绩分布 ★问卷星

### 5.2 分类统计（单题与分组统计）★问卷星

以问卷中一道或多道**选择题**的选项，或**填写者 IP 所在省份/城市**、**答卷来源渠道**为分类依据，得到每一类的统计报告（相当于「按某维度切分的单题统计」）。

- **按题目选项分类**：如按性别、部门、年龄等得到「女性员工满意度」「市场部满意度」等子报表 ★问卷星
- **多维度组合**：如按「部门 + 性别」得到「市场部女性员工」「销售部男性员工」等细分统计 ★问卷星
- **按地区分类**：按 IP 省份/城市统计各地区答卷分布与各题统计 ★问卷星
- **按来源渠道分类**：按链接参数、来源页、调研员等统计各渠道的答卷与各题统计 ★问卷星

单题统计本身（每道题的图表与数值）仍保留，并与分类统计结合：在「某类答卷」下查看各题统计。

### 5.3 单题统计与图表（分类统计基础）

- **单选/多选/下拉**  
  - 选项计数、占比；**统计图表中百分比计算方式**可配置（如占有效答卷比、占总答卷比）★问卷星  
  - 图表：饼图、柱状图（可切换）  
- **填空/多行填空**  
  - 答案列表（可分页）、词频/词云（可选）  
- **矩阵题**  
  - 每行各选项的计数/占比，表格或图；**矩阵题平均分**计算方式（如按行或按列）★问卷星  
- **量表/评分/滑动条**  
  - 各分值计数、平均分、分布图（柱状/折线）；**数值型与滑动条题可自动分段统计**（如 0–60、60–80、80–100）★问卷星  
- **排序题**  
  - 各选项的平均排名或排名分布  
- **日期/时间**  
  - 分布（按日/周/月汇总）  
- **上传文件**  
  - 文件列表与下载  

### 5.4 交叉分析 ★问卷星

- 选择两个题目（如 A、B），以 A 的选项为维度，展示 B 在各维度下的统计（如 A 选「男」时 B 的选项分布）。
- **自定义数据源**：支持使用自定义数据源进行交叉分析（如外部导入的维度表）★问卷星
- 展示形式：表格、堆叠柱状图等；提供**交叉分析数据计算说明**（分母、占比口径等）★问卷星

### 5.5 自定义查询 ★问卷星

- 用户**自定义查询条件**（多条件组合），筛选出符合条件的答卷子集。
- 可基于查询结果进行查看、导出、分享「符合条件的数据」；与答卷列表筛选能力互补，适合复杂条件（如「第 1 题选 A 且第 3 题选 B 且来源为某渠道」）。

### 5.6 导出（下载原始答卷 / 下载到 SPSS）★问卷星

- **下载原始答卷**  
  - **按选项序号下载（Excel）**：选项以序号（1、2、3…）存储，导入 SPSS 后为数值型，便于设置值标签；**推荐用于 SPSS 分析** ★问卷星  
  - **按选项文本下载（Excel）**：选项以文本存储，便于人工阅读；导入 SPSS 需再转数值（若做统计）。  
  - 每行一条答卷，每列一题；多选/矩阵需约定列格式（多列或合并）。  
  - 元数据列：提交时间、所用时间、IP、来源等，导出时可勾选包含/排除。  
- **CSV**  
  - 与 Excel 列一致，便于其他工具导入。  
- **下载到 SPSS（.sav）**  
  - 直接导出为 SPSS 格式；注意编码（如 UTF-8）避免乱码，问卷星提供「SPSS 乱码解决方法」类说明 ★问卷星  
- **下载调查报告**  
  - 将当前统计结果（含图表、分类统计、交叉分析等）生成**调查报告**（如 Word/PDF），可下载 ★问卷星  
- 导出范围：可选「全部答卷」「仅有效答卷」「当前筛选/查询结果」。

### 5.7 高级分析（可选对标）★问卷星

- **多问卷数据分析**：对多个问卷的数据进行联合分析（如同一主题多期问卷合并对比）★问卷星  
- **SPSS 分析（在线）**：信度分析、效度分析、相关分析、回归分析、方差分析等，在问卷星内完成部分统计，无需导出到桌面 SPSS ★问卷星  
- **问卷数据大屏**：将关键指标与图表以**数据大屏**形式展示（大屏/投屏场景）★问卷星  
- **洞察报告**：深度数据分析与洞察报告（部分版本/AI 相关）★问卷星  

### 5.8 测评报告与考试场景 ★问卷星

- **测评报告**：针对测评/考试类问卷，输出**最终测评结果**（如 DISC 性格、维度得分、等级）；支持按题目或维度设置计分规则，自动汇总 ★问卷星  
- **成绩分布、排名查询**：按班级、院系等查看成绩分布图、排名；与「数据对外查询/成绩查询」配合，填写者可凭唯一码查询自己的结果 ★问卷星  

### 5.9 效率工具（可选）★问卷星

- 问卷星在统计分析下提供**效率工具**类功能（如批量操作、快捷筛选、常用分析模板等），可按实际产品再细化 ★问卷星  

### 5.10 数据安全与隐私

- 创建者可随时**清空答卷**或**删除单条**（含导出记录若做了审计）。
- **隐藏参与者信息**：列表中或导出时可脱敏（如隐藏 IP、姓名、学号等），依权限与合规设置 ★问卷星  
- 若支持「填写者登录」，需在隐私说明中约定数据用途与保留期限（产品层面）。
- **分享与权限**：分享「特定条件数据」时，可控制可见范围与是否允许再导出，避免数据外泄 ★问卷星  

---

## 六、模板与复用

### 6.1 问卷模板
- 系统内置模板：如满意度、NPS、报名表、考试测验等，用户可基于模板创建问卷
- 用户自定义模板：将已有问卷存为「我的模板」，下次从模板新建
- 模板市场（可选）：公开模板库、分类、使用次数展示

### 6.2 复制问卷
- 在本账号下复制整份问卷（含题目、设置、逻辑跳题），生成新问卷（草稿），不复制答卷数据

### 6.3 题库（可选）
- 用户可把单题保存到个人题库，新建问卷时从题库选题插入
- 题库分类、标签、搜索

---

## 七、其他与全局

### 7.1 问卷状态与生命周期
- 草稿：仅创建者可见、可编辑，不可填写
- 收集中：按「开始时间」开放填写，受「结束时间/最大份数」约束
- 已结束：不可再提交，可查看/导出数据、复制、重新发布（可选）

### 7.2 异常与限制
- 问卷被删除：填写链接提示「问卷不存在或已删除」
- 未到开始时间 / 已过结束时间：提示具体原因
- 回收已满：提示「回收已满，感谢关注」
- 防重复未通过：统一提示文案，可配置

### 7.3 管理端（可选）
- 平台管理员：用户列表、问卷列表、违规下架、系统公告
- 基础数据统计：总用户数、总问卷数、总回收数

### 7.4 帮助与说明
- 填写说明/隐私说明（可配置在问卷说明或全局页脚）
- 常见问题、联系客服（若做）

---

## 八、功能优先级建议（供排期参考）

**P0（首版必做）**  
- **高校**：CAS 登录对接、用户身份/院系信息获取与展示（二、高校对接 2.2–2.3）；可选「仅登录用户可填」与按用户防重复（2.5）。  
- 用户注册/登录（本地账号，与 CAS 并存）、个人中心、我的问卷  
- 问卷 CRUD，题型：单选、多选、填空、多行填空、量表、描述、分页  
- 题目必填、选项随机（单选/多选）  
- 问卷设置：标题/说明、感谢语、开始/结束时间、最大回收数  
- 填写链接与二维码、填写页与提交、防重复（同一设备 / 同一用户）  
- 答卷列表、单题统计（饼图/柱状图）、导出 Excel/CSV  

**P1（第二版）**  
- **高校**：按院系/身份权限控制（2.4）、按院系统计与筛选、多 CAS 配置（多校部署）。  
- 逻辑跳题（单选/下拉）  
- 题型：下拉单选/多选、矩阵单选、排序、日期、时间  
- 填空校验、多选最少/最多项  
- 嵌入 iframe、提交后跳转链接  
- 单题统计增强、交叉分析  
- 复制问卷、问卷状态（草稿/收集中/已结束）  

**P2（后续迭代）**  
- 上传文件题、矩阵多选/填空、NPS/满意度量表细化  
- 外观主题、进度条、编号样式  
- 同一用户防重复、IP 限频  
- 模板与模板市场、题库  
- 导出 SPSS、答卷筛选按题  

以上为完整功能整理，实现时按模块与优先级拆任务即可。
